# ğŸ“š HX-SayBook

> AI å¤šè§’è‰²å¤šæƒ…ç»ªå°è¯´é…éŸ³å¹³å°(åŸºäº [SonicVale / éŸ³è°·](https://github.com/xcLee001/SonicVale) äºŒæ¬¡å¼€å‘)

å°†å°è¯´æ–‡æœ¬é€šè¿‡ LLM è‡ªåŠ¨æ‹†åˆ†ä¸ºå¸¦è§’è‰²ã€æƒ…ç»ªçš„å°è¯, ç„¶åé€šè¿‡ TTS(å¦‚ Index-TTS)åˆæˆå¤šè§’è‰²é…éŸ³éŸ³é¢‘ã€‚

## âœ¨ æ–°å¢åŠŸèƒ½(ç›¸æ¯”åŸé¡¹ç›®)

- ğŸ¯ **æ‰¹é‡LLMè§£æ** â€” æ”¯æŒé€‰æ‹©ç« èŠ‚èŒƒå›´, æ‰¹é‡é˜Ÿåˆ—è½¬åŒ–, å…¨ç¨‹æ˜¾ç¤ºæ—¥å¿—å’Œè¿›åº¦, æ”¯æŒå¹¶å‘æ§åˆ¶å’Œå–æ¶ˆ
- â­ï¸ **è·³è¿‡å·²è§£æç« èŠ‚** â€” æ‰¹é‡ LLM è§£ææ—¶è‡ªåŠ¨è·³è¿‡å·²æœ‰å°è¯çš„ç« èŠ‚, é˜²æ­¢é‡å¤ç”Ÿæˆ(é»˜è®¤å¼€å¯, å¯å…³é—­)
- ğŸ™ï¸ **æ‰¹é‡TTSé…éŸ³** â€” æŒ‰ç« èŠ‚ä¸€é”®é…éŸ³, WebSocket å®æ—¶æ¨é€è¿›åº¦
- âš¡ **å¼‚æ­¥åç¨‹å¼•æ“** â€” LLM/TTS å¼•æ“å…¨é¢æ”¹ä¸º async éé˜»å¡è°ƒç”¨, æ•°æ®åº“è¿æ¥æ± å¼‚æ­¥åŒ–, é«˜å¹¶å‘ä¸‹ä¸å†é˜»å¡çº¿ç¨‹
- ğŸ”„ **LLM + TTS å¹¶è¡Œæµæ°´çº¿** â€” ä¸€é”®æŒ‚æœºæ¨¡å¼ä¸‹ LLM è§£æä¸ TTS é…éŸ³å¹¶è¡Œæ‰§è¡Œ, å¤§å¹…ç¼©çŸ­æ•´ä½“è€—æ—¶
- ğŸ­ **è·¯äººè¯­éŸ³æ± ** â€” ä¸ºé¡¹ç›®é…ç½®è·¯äººè¯­éŸ³æ± , è‡ªåŠ¨éšæœºåˆ†é…éŸ³è‰²ç»™æœªç»‘å®šè§’è‰², è§’è‰²æŒ‰å¯¹è¯æ¬¡æ•°æ’åº
- ğŸšï¸ **è¯­éŸ³é€Ÿåº¦è°ƒèŠ‚** â€” å…¨å±€/å•æ¡å°è¯é€Ÿåº¦è°ƒèŠ‚, 0.5x ~ 2.0x
- ğŸ”§ **ç‹¬ç«‹è¯­éŸ³è°ƒè¯•é¡µé¢** â€” è„±ç¦»ä¸šåŠ¡æµç¨‹, å¿«é€Ÿæµ‹è¯•éŸ³è‰²/æƒ…ç»ª/é€Ÿåº¦ç»„åˆ
- ğŸ“ **å­—å¹•å¯¼å‡º** â€” æ”¯æŒå¯¼å‡º SRT/ASS é€šç”¨æ ¼å¼å­—å¹•æ–‡ä»¶, å¯¹åº”æ¯ä¸€æ¡åˆå¹¶å¯¼å‡ºçš„éŸ³é¢‘
- ğŸ¬ **å•ç« ä¸€é”®å¯¼å‡º** â€” æ“ä½œæ ä¸€é”®å¯¼å‡ºæœ¬ç« éŸ³é¢‘(MP3)åŠå¯¹åº”å­—å¹•(SRT/ASS), éŸ³é¢‘å¤±è´¥åˆ™ä¸å¯¼å‡ºå­—å¹•
- ï¿½ **åˆå¹¶å¯¼å‡ºåˆ†æ®µ** â€” åˆå¹¶å¯¼å‡ºæ”¯æŒæŒ‰æ—¶é•¿åˆ†æ®µ(ä»¥ç« èŠ‚ä¸ºæœ€å°å•ä½, ä¸æˆªæ–­å¯¹è¯), æ”¯æŒèŒƒå›´é€‰æ‹©
- ï¿½ğŸ“Š **å®æ—¶è¿›åº¦å’Œæ—¥å¿—** â€” æ‰€æœ‰ LLM/TTS æ“ä½œéƒ½æ˜¾ç¤ºè¯¦ç»†æ—¥å¿—, ä¸å†åªæ˜¯"åŠ è½½ä¸­"
- ğŸŒ **Web å‰ç«¯** â€” ä» Electron+Vue é‡æ„ä¸º React+TypeScript Web ç«¯
- ğŸ“¦ **uv åŒ…ç®¡ç†** â€” ä½¿ç”¨ uv æ›¿ä»£ pip, æ›´å¿«çš„ä¾èµ–å®‰è£…
- ğŸ–¥ï¸ **è·¨å¹³å°** â€” æ”¯æŒ Windows å’Œ Arch Linux
- ğŸ”Œ **Index-TTS ä¸€é”®å®‰è£…** â€” æä¾›å®‰è£…è„šæœ¬, æ”¯æŒ 8GB æ˜¾å­˜æ¨¡å¼
- ğŸ¤ **éŸ³è‰²ä¸Šä¼ ç®¡ç†** â€” æ”¯æŒä¸Šä¼ è‡ªå®šä¹‰å‚è€ƒéŸ³é¢‘åˆ›å»º/ç¼–è¾‘éŸ³è‰², éŸ³è‰²å¡ç‰‡æ”¯æŒè¯•å¬å’Œåˆ é™¤
- ğŸ§  **LLM è§£æé‡è¯•ä¸é™æµé€€é¿** â€” æ‰¹é‡è§£æé‡åˆ°é€Ÿç‡é™åˆ¶è‡ªåŠ¨æŒ‡æ•°é€€é¿é‡è¯•, æ¯æ®µæœ€å¤šé‡è¯• 3 æ¬¡
- ğŸ­ **å¤åˆæƒ…ç»ªæ”¯æŒ** â€” æƒ…ç»ªåˆ—è¡¨æ‰©å±•å¤åˆæƒ…ç»ª(ç–‘æƒ‘/ç´§å¼ /æ— å¥ˆ/å¾—æ„/å˜²è®½ç­‰), æç¤ºè¯å¼ºåˆ¶ LLM ä¸¥æ ¼ä»æƒ…ç»ªåˆ—è¡¨é€‰æ‹©
- ğŸ”Š **TTS å¤šæƒ…ç»ªå‘é‡** â€” Index-TTS æ”¯æŒå¤šç»´åº¦æƒ…ç»ªå‘é‡ä¼ é€’, åŒ…æ‹¬åŸºç¡€å’Œå¤åˆæƒ…ç»ªæ˜ å°„
- ğŸ”„ **é‡æ–°è§£æè‡ªåŠ¨æ¸…æ—§** â€” æ‰¹é‡ LLM é‡æ–°è§£æç« èŠ‚æ—¶è‡ªåŠ¨æ¸…é™¤æ—§å°è¯, é¿å…é‡å¤å åŠ 
- ğŸ¨ **UI æ‰¹é‡æ“ä½œä¼˜åŒ–** â€” æ‰¹é‡ LLM/TTS/ä¸€é”®æŒ‚æœºå¼¹çª—æ”¯æŒ Drawer æŠ½å±‰æ¨¡å¼, ç« èŠ‚èŒƒå›´é€‰æ‹©æ›´çµæ´»
- ğŸ‡¯ğŸ‡µ **æ—¥è¯­ TTS æ”¯æŒ** â€” é¡¹ç›®å’Œè¯­éŸ³è°ƒè¯•æ”¯æŒä¸­æ—¥è¯­åˆ‡æ¢, Index-TTS API Server åŠ¨æ€åŠ è½½/å¸è½½æ¨¡å‹, å•æ¨¡å‹åˆ‡æ¢èŠ‚çœ GPU æ˜¾å­˜
- ğŸ“ **æ•°æ®ç›®å½•æ”¹ä¸ºé¡¹ç›®å†…** â€” ç”¨æˆ·æ•°æ®(æ•°æ®åº“ã€éŸ³é¢‘ç­‰)å­˜æ”¾åœ¨ `py/user_data/`, ç®€åŒ–éƒ¨ç½²å’Œè¿ç§»
- ğŸ”‡ **ç§»é™¤é»˜è®¤éŸ³è‰²èµ„æºåŒ…** â€” ä¸å†å†…ç½®é»˜è®¤éŸ³è‰², æ”¹ä¸ºç”¨æˆ·è‡ªè¡Œä¸Šä¼ ç®¡ç†
- ğŸ”Š **ä¿®å¤è¯•å¬è¯¯æŠ¥é”™è¯¯** â€” ä¿®å¤éŸ³è‰²è¯•å¬æ—¶æµè§ˆå™¨ AbortError å¯¼è‡´è¯¯æç¤º"æ’­æ”¾å¤±è´¥"

## ğŸ—ï¸ æŠ€æœ¯æ ˆ

| æ¨¡å— | æŠ€æœ¯ |
|------|------|
| åç«¯ | Python 3.10+ / FastAPI / SQLAlchemy / WebSocket |
| å‰ç«¯ | React 19 / TypeScript / Vite / Ant Design / Zustand |
| TTS | Index-TTS (å¯é€‰) / è‡ªå®šä¹‰ TTS API |
| LLM | OpenAI å…¼å®¹ API |
| åŒ…ç®¡ç† | uv (Python) / npm (å‰ç«¯) |
| éƒ¨ç½² | æ”¯æŒ Docker / æœ¬åœ°ç›´æ¥è¿è¡Œ |

## ğŸ“ é¡¹ç›®ç»“æ„

```
HX-SayBook/
â”œâ”€â”€ py/                     # åç«¯ (FastAPI)
â”‚   â”œâ”€â”€ core/               # æ ¸å¿ƒå¼•æ“ (LLM, TTS, éŸ³é¢‘å¤„ç†)
â”‚   â”œâ”€â”€ routers/            # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ batch_router.py # æ–°å¢: æ‰¹é‡å¤„ç†è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ chapter_router.py
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ services/           # ä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ models/             # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ db/                 # æ•°æ®åº“
â”‚   â””â”€â”€ main.py             # å…¥å£
â”œâ”€â”€ web/                    # å‰ç«¯ (React + TS)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ api/            # API å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ hooks/          # è‡ªå®šä¹‰ Hook (WebSocket)
â”‚   â”‚   â”œâ”€â”€ pages/          # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ store/          # Zustand çŠ¶æ€ç®¡ç†
â”‚   â”‚   â””â”€â”€ types/          # TypeScript ç±»å‹
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ scripts/                # å·¥å…·è„šæœ¬
â”‚   â””â”€â”€ install_index_tts.sh
â”œâ”€â”€ pyproject.toml          # Python é¡¹ç›®é…ç½® (uv)
â”œâ”€â”€ start.sh                # Linux å¯åŠ¨è„šæœ¬
â””â”€â”€ start.bat               # Windows å¯åŠ¨è„šæœ¬
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨åç«¯

```bash
# æ–¹å¼ä¸€: ä½¿ç”¨å¯åŠ¨è„šæœ¬(æ¨è)
chmod +x start.sh
./start.sh

# æ–¹å¼äºŒ: æ‰‹åŠ¨å¯åŠ¨
uv sync
uv run uvicorn py.main:app --host 0.0.0.0 --port 8200 --reload
```

### 2. å¯åŠ¨å‰ç«¯

```bash
cd web
npm install
npm run dev
# è®¿é—® http://localhost:3000
```

### 3. (å¯é€‰) å®‰è£… Index-TTS

Index-TTS æ˜¯ä¸€ä¸ªé«˜è´¨é‡é›¶æ ·æœ¬è¯­éŸ³å…‹éš†æ¨¡å‹, æ”¯æŒå¤šæƒ…ç»ªåˆæˆã€‚å®‰è£…åå¯ä½œä¸º TTS æœåŠ¡ä¾› HX-SayBook è°ƒç”¨ã€‚

#### 3.1 ä¸€é”®å®‰è£…

```bash
chmod +x scripts/install_index_tts.sh
./scripts/install_index_tts.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆ: å…‹éš†ä»“åº“ â†’ æ£€æµ‹ GPU/CPU â†’ å®‰è£…ä¾èµ– â†’ ä¸‹è½½æ¨¡å‹ â†’ åˆ›å»ºå¯åŠ¨è„šæœ¬

> âš ï¸ **æ—  NVIDIA GPU** æ—¶ä¼šè‡ªåŠ¨å®‰è£… CPU ç‰ˆ PyTorch, åŠŸèƒ½å®Œæ•´ä½†æ¨ç†è¾ƒæ…¢

#### 3.2 ä¸‹è½½æ¨¡å‹(å¦‚è„šæœ¬æœªè‡ªåŠ¨å®Œæˆ)

æ¨¡å‹æ–‡ä»¶éœ€æ”¾åœ¨ `scripts/index-tts/checkpoints/` ç›®å½•ä¸‹:

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `bpe.model` | BPE åˆ†è¯æ¨¡å‹ |
| `gpt.pth` | GPT è¯­è¨€æ¨¡å‹ |
| `config.yaml` | æ¨¡å‹é…ç½®(å·²è‡ªå¸¦) |
| `s2mel.pth` | å£°å­¦æ¨¡å‹ |
| `wav2vec2bert_stats.pt` | ç‰¹å¾æå–ç»Ÿè®¡ |
| `feat1.pt` | è¯´è¯äººç‰¹å¾çŸ©é˜µ |
| `feat2.pt` | æƒ…æ„Ÿç‰¹å¾çŸ©é˜µ |
| `qwen0.6bemo4-merge/` | Qwen æƒ…æ„Ÿç¼–ç æ¨¡å‹ |

ä¸‹è½½æ–¹å¼(ä¸‰é€‰ä¸€):

```bash
# æ–¹å¼1: ModelScope(å›½å†…æ¨è)
pip install modelscope
modelscope download --model IndexTeam/IndexTTS-2 --local_dir scripts/index-tts/checkpoints

# æ–¹å¼2: HuggingFace é•œåƒç«™
pip install huggingface_hub[cli]
HF_ENDPOINT=https://hf-mirror.com hf download IndexTeam/IndexTTS-2 --local-dir scripts/index-tts/checkpoints

# æ–¹å¼3: HuggingFace å®˜æ–¹
pip install huggingface_hub[cli]
hf download IndexTeam/IndexTTS-2 --local-dir scripts/index-tts/checkpoints
```

#### 3.3 å¯åŠ¨ TTS API æœåŠ¡

```bash
cd scripts/index-tts
./start_tts_server.sh

# æˆ–æ‰‹åŠ¨å¯åŠ¨
source .venv/bin/activate  # æˆ– source venv/bin/activate
python api_server.py --host 0.0.0.0 --port 8000
```

å¯åŠ¨æˆåŠŸå, API æœåŠ¡è¿è¡Œåœ¨ `http://127.0.0.1:8000`

#### 3.4 å¯¹æ¥ HX-SayBook

1. å¯åŠ¨ HX-SayBook åç«¯(`./start.sh`)
2. æ‰“å¼€å‰ç«¯, è¿›å…¥ **é…ç½®ä¸­å¿ƒ**
3. æ‰¾åˆ° TTS ä¾›åº”å•† `index_tts`(ç³»ç»Ÿè‡ªåŠ¨åˆ›å»º)
4. å¡«å…¥ API åœ°å€: `http://127.0.0.1:8000`
5. ç‚¹å‡» **æµ‹è¯•è¿æ¥**, æ˜¾ç¤ºæˆåŠŸå³å¯

## ğŸ“– ä½¿ç”¨æµç¨‹

1. **é…ç½®ä¸­å¿ƒ** â€” æ·»åŠ  LLM å’Œ TTS æœåŠ¡æä¾›å•†
2. **åˆ›å»ºé¡¹ç›®** â€” æ–°å»ºé¡¹ç›®å¹¶å…³è” LLM/TTS/æç¤ºè¯
3. **å¯¼å…¥ç« èŠ‚** â€” ç²˜è´´å°è¯´æ–‡æœ¬
4. **LLM è§£æ** â€” å•ç« æˆ–æ‰¹é‡è§£æ, è‡ªåŠ¨æ‹†åˆ†å°è¯å¹¶è¯†åˆ«è§’è‰²/æƒ…ç»ª
5. **è§’è‰²ç»‘å®š** â€” ä¸ºè§’è‰²åˆ†é…éŸ³è‰²
6. **TTS é…éŸ³** â€” å•ç« æˆ–æ‰¹é‡é…éŸ³, å®æ—¶æŸ¥çœ‹è¿›åº¦
7. **è¯­éŸ³è°ƒè¯•** â€” åœ¨ç‹¬ç«‹é¡µé¢å¾®è°ƒéŸ³è‰²/æƒ…ç»ª/é€Ÿåº¦
8. **å¯¼å‡ºéŸ³é¢‘** â€” å¯¼å‡ºæœ€ç»ˆé…éŸ³æ–‡ä»¶

## ğŸ”§ ç¯å¢ƒè¦æ±‚

- Python 3.10+
- Node.js 18+
- ffmpeg(ç³»ç»Ÿ PATH ä¸­æˆ–æ”¾åˆ° `py/core/ffmpeg/` ä¸‹)
- (å¯é€‰) NVIDIA GPU + CUDA(Index-TTS GPU åŠ é€Ÿéœ€è¦, CPU æ¨¡å¼ä¹Ÿå¯ç”¨)

## ğŸ“ License

AGPL-3.0
